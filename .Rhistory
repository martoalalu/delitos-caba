theme_void()
ggmap(CABA) +
geom_bin2d(data = delitos,
aes(x = longitud, y = latitud), bins = 100, alpha = 0.8) +
facet_wrap(~tipo_delito)+
labs(title="Distribución de delitos",
subtitle="Ciudad Autónoma de Buenos Aires",
x="",
y="",
caption= "Fuente de datos: https://https://mapa.seguridadciudad.gob.ar/",
fill="Cantidad")+
scale_fill_distiller(palette = "Spectral")+
theme_void()
View(delitos)
theme_void()
ggmap(CABA) +
geom_bin2d(data = filter(delitos,delitos$tipo_delito=="Lesiones Seg Vial",
aes(x = longitud, y = latitud), bins = 100, alpha = 0.8) +
labs(title="Distribución de delitos",
subtitle="Ciudad Autónoma de Buenos Aires",
x="",
y="",
caption= "Fuente de datos: https://https://mapa.seguridadciudad.gob.ar/",
fill="Cantidad")+
scale_fill_distiller(palette = "Spectral")+
theme_void()
ggmap(CABA) +
geom_bin2d(data = filter(delitos,delitos$tipo_delito=="Lesiones Seg Vial"),
aes(x = longitud, y = latitud), bins = 100, alpha = 0.8) +
labs(title="Distribución de delitos",
subtitle="Ciudad Autónoma de Buenos Aires",
x="",
y="",
caption= "Fuente de datos: https://https://mapa.seguridadciudad.gob.ar/",
fill="Cantidad")+
scale_fill_distiller(palette = "Spectral")+
theme_void()
ggmap(CABA) +
geom_bin2d(data = filter(delitos,tipo_delito=="Lesiones Seg Vial"),
aes(x = longitud, y = latitud), bins = 100, alpha = 0.8) +
labs(title="Distribución de delitos",
subtitle="Ciudad Autónoma de Buenos Aires",
x="",
y="",
caption= "Fuente de datos: https://https://mapa.seguridadciudad.gob.ar/",
fill="Cantidad")+
scale_fill_distiller(palette = "Spectral")+
theme_void()
ggmap(CABA) +
stat_density_2d(data = delitos),
aes(x = longitud, y = latitud,
fill = stat(level)), alpha = 0.6, geom = "polygon") +
labs(title="Distribución de delitos",
subtitle="Ciudad Autónoma de Buenos Aires",
x="",
y="",
caption= "Fuente de datos: https://data.buenosaires.gob.ar/",
fill="Nivel")+
scale_fill_distiller(palette = "Spectral")+
theme_void()+
facet_wrap(~tipo_delito)
ggmap(CABA) +
stat_density_2d(data = delitos,
aes(x = longitud, y = latitud,
fill = stat(level)), alpha = 0.6, geom = "polygon") +
labs(title="Distribución de delitos",
subtitle="Ciudad Autónoma de Buenos Aires",
x="",
y="",
caption= "Fuente de datos: https://data.buenosaires.gob.ar/",
fill="Nivel")+
scale_fill_distiller(palette = "Spectral")+
theme_void()+
facet_wrap(~tipo_delito)
calles <- read_sf("http://cdn.buenosaires.gob.ar/datosabiertos/datasets/calles/avenida_rivadavia.geojson")
View(calles)
calles <- read_sf("C:/Users/20332842324/Desktop/callejero.shp")
write_sf(calles,"C:/Users/20332842324/Desktop/callejero.geojson")
calles <- read_sf("https://github.com/martoalalu/delitos-caba/blob/master/data/callejero.geojson")
calles <- read_sf("http://cdn.buenosaires.gob.ar/datosabiertos/datasets/calles/callejero.geojson")
calles <- read_sf("http://cdn.buenosaires.gob.ar/datosabiertos/datasets/calles/callejero.geojson")
calles <- read_sf("http://cdn.buenosaires.gob.ar/datosabiertos/datasets/calles/callejero.geojson")
radios <- read_sf("http://cdn.buenosaires.gob.ar/datosabiertos/datasets/informacion-censal-por-radio/caba_radios_censales.geojson")
View(radios)
calles <- read_sf("http://cdn.buenosaires.gob.ar/datosabiertos/datasets/calles/callejero.geojson")
barrios <- radios %>%
group_by(BARRIO) %>%
summarise(poblacion_barrio=sum(POBLACION))
View(barrios)
ggplot() +
geom_sf(data = barrios, aes(fill = poblacion_barrio), color = NA) +
labs(title = "Actividad Comercial por Barrio",
subtitle="Ciudad Autónoma de Buenos Aires",
fill = "Cantidad",
caption= "Fuente de datos: https://data.buenosaires.gob.ar/")+
scale_fill_viridis_c(alpha = 0.9)
calles <- read_sf("http://cdn.buenosaires.gob.ar/datosabiertos/datasets/calles/callejero.geojson")
delitos_barrio <- delitos %>%
group_by(barrio) %>%
summarise(cant_delitos=n())
View(delitos_barrio)
delitos_barrio <- delitos_barrio %>%
left_join(barrios)
library(janitor)
calles <- read_sf("http://cdn.buenosaires.gob.ar/datosabiertos/datasets/calles/callejero.geojson")
#Poblacion por barrio
barrios <- radios %>%
group_by(BARRIO) %>%
summarise(poblacion_barrio=sum(POBLACION)) %>%
clean_names()
barrios <- barrios %>%
left_join(delitos_barrios)
barrios <- barrios %>%
left_join(delitos_barrio)
View(barrios)
View(barrios)
barrios <- barrios %>%
mutate(delitos_hab=cant_delitos/poblacion_barrio)
ggplot() +
geom_sf(data = barrios, aes(fill = delitos_hab), color = NA) +
labs(title = "Delitos por habitante en barrios",
subtitle="Ciudad Autónoma de Buenos Aires",
fill = "Cantidad",
caption= "Fuente de datos: https://data.buenosaires.gob.ar/")+
scale_fill_viridis_c(alpha = 0.9)
calles_delitos <- st_join(calles, delitos_geo)
View(calles_delitos)
View(calles)
knitr::opts_chunk$set(echo = TRUE, warning=FALSE, message=FALSE)
library(data.table)
library(tidyverse)
library(sf)
library(ggplot2)
library(dplyr)
library(viridis)
library(data.table)
library(ggmap)
library(janitor)
library(ggdark)
library(leaflet)
library(lubridate)
library(GGally)
library(directlabels)
install.packages("directlabels")
delitos <- fread("https://raw.githubusercontent.com/martoalalu/delitos-caba/master/data/delitos.csv",encoding = 'UTF-8')
install.packages("directlabels")
knitr::opts_chunk$set(echo = TRUE, warning=FALSE, message=FALSE)
library(data.table)
library(tidyverse)
library(sf)
library(ggplot2)
library(dplyr)
library(viridis)
library(data.table)
library(ggmap)
library(janitor)
library(ggdark)
library(leaflet)
library(lubridate)
library(GGally)
library(directlabels)
install.packages("directlabels")
delitos <- fread("https://raw.githubusercontent.com/martoalalu/delitos-caba/master/data/delitos.csv",encoding = 'UTF-8')
barrios_replace<- c("COGHLAND", "LA BOCA", "VILLA GRAL MITRE", "MONTSERRAT")
delitos <- delitos %>%
mutate(fecha=ymd(fecha)) %>%
mutate(anio=year(fecha)) %>%
mutate(anio_mes = floor_date(as_date(fecha), "month")) %>%
mutate(barrio = case_when(grepl(paste(barrios_replace[1]), barrio) ~ "COGHLAN",
grepl(paste(barrios_replace[2]), barrio) ~ "BOCA",
grepl(paste(barrios_replace[3]), barrio) ~ "VILLA GRAL. MITRE",
grepl(paste(barrios_replace[4]), barrio) ~ "MONSERRAT",
TRUE~barrio))
nrow(delitos)/(365*3)
delitos
delitos %>%
count(anio) %>%
mutate(pct=(n/sum(n))*100)
delitos %>%
ggplot(aes(anio))+
geom_bar(aes(fill=as.factor(tipo_delito)))+
labs(title="Distribución de delitos por año (2016-2018)",
subtitle="Ciudad Autónoma de Buenos Aires",
caption= "Fuente de datos: https://https://mapa.seguridadciudad.gob.ar/",
fill="Tipo de delito")
delitos %>%
count(anio_mes,tipo_delito) %>%
ggplot() +
geom_line(aes(x=anio_mes, y=n, color=tipo_delito))+
xlab("")+
labs(title="Distribución de delitos por mes (2016-2018)",
subtitle="Ciudad Autónoma de Buenos Aires",
caption= "Fuente de datos: https://https://mapa.seguridadciudad.gob.ar/",
fill="Tipo de delito")
#Creamos df con delitos de robo y hurto que tengan coordenadas
delitos_geo <- delitos %>%
filter(!is.na(longitud), !is.na(latitud)) %>%
filter(longitud != 0) %>%
filter(tipo_delito=="Robo (Con violencia)" | tipo_delito=="Hurto (Sin violencia)") %>%
st_as_sf(coords = c("longitud", "latitud"), crs = 4326)
#Nos quedamos solo con los delitos ocurridos en la Ciudad de Buenos Aires
radios <- read_sf("http://cdn.buenosaires.gob.ar/datosabiertos/datasets/informacion-censal-por-radio/caba_radios_censales.geojson")
delitos_caba <- delitos_geo[st_within(delitos_geo, radios) %>% lengths > 0,]
delitos_caba<- delitos_caba %>%
mutate(long=st_coordinates(delitos_caba)[,1],
lat=st_coordinates(delitos_caba)[,2])
bbox <- c(-58.546686,
-34.711145,
-58.329097,
-34.529156)
CABA <- get_stamenmap(bbox = bbox,
maptype = "toner-lite",
zoom=13)
ggmap(CABA) +
stat_density_2d(data = filter(delitos_caba,tipo_delito=="Robo (Con violencia)"),
aes(x = long, y = lat,
fill = stat(level)), alpha = 0.6, geom = "polygon") +
labs(title="Distribución de Robo (con violencia) 2016-2018",
subtitle="Ciudad Autónoma de Buenos Aires",
x="",
y="",
caption= "Fuente de datos: https://mapa.seguridadciudad.gob.ar/",
fill="Cantidad")+
scale_fill_distiller(palette = "Spectral")+
theme_void()+
facet_wrap(~anio)
ggmap(CABA) +
stat_density_2d(data = filter(delitos_caba,tipo_delito=="Hurto (Sin violencia)"),
aes(x = long, y = lat,
fill = stat(level)), alpha = 0.6, geom = "polygon") +
labs(title="Distribución de Hurto (sin violencia) 2016-2018",
subtitle="Ciudad Autónoma de Buenos Aires",
x="",
y="",
caption= "Fuente de datos: https://mapa.seguridadciudad.gob.ar/",
fill="Cantidad")+
scale_fill_distiller(palette = "Spectral")+
theme_void()+
facet_wrap(~anio)
#Poblacion por barrio
barrios <- radios %>%
group_by(BARRIO) %>%
summarise(poblacion_barrio=sum(POBLACION)) %>%
clean_names()
#Mapeamos poblacion
ggplot() +
geom_sf(data = barrios, aes(fill = poblacion_barrio), color = NA) +
labs(title = "Poblacion por Barrio",
subtitle="Ciudad Autónoma de Buenos Aires",
fill = "Cantidad",
caption= "Fuente de datos: https://mapa.seguridadciudad.gob.ar/")+
scale_fill_viridis_c(alpha = 0.9)
delitos_caba_geo <- delitos_caba
st_geometry(delitos_caba) <- NULL
#Delitos por barrio
delitos_barrio <- delitos_caba %>%
group_by(barrio, tipo_delito, anio) %>%
summarise(cant_delitos=n())
delitos_barrio_robo <- filter(delitos_barrio, tipo_delito=="Robo (Con violencia)")
delitos_barrio_hurto <- filter(delitos_barrio, tipo_delito=="Hurto (Sin violencia)")
ggpubr::ggarrange(ncol=3, nrow=1,
barrios %>%
left_join(filter(delitos_barrio_robo, anio==2016)) %>%
mutate(delitos_hab=cant_delitos/poblacion_barrio) %>%
ggplot() +
geom_sf(aes(fill = delitos_hab), color = NA) +
labs(title = "Robos 2016",
subtitle="CABA")+
scale_fill_viridis_c(alpha = 0.9)+
theme_void()+
guides(fill=FALSE)
,
barrios %>%
left_join(filter(delitos_barrio_robo, anio==2017)) %>%
mutate(delitos_hab=cant_delitos/poblacion_barrio) %>%
ggplot() +
geom_sf(aes(fill = delitos_hab), color = NA) +
labs(title = "Robos 2017",
subtitle="CABA")+
scale_fill_viridis_c(alpha = 0.9)+
theme_void()+
guides(fill=FALSE),
barrios %>%
left_join(filter(delitos_barrio_robo, anio==2018)) %>%
mutate(delitos_hab=cant_delitos/poblacion_barrio) %>%
ggplot() +
geom_sf(aes(fill = delitos_hab), color = NA) +
labs(title = "Robos 2018",
subtitle="CABA")+
scale_fill_viridis_c(alpha = 0.9)+
theme_void()+
guides(fill=FALSE)
)
ggpubr::ggarrange(ncol=3, nrow=1,
barrios %>%
left_join(filter(delitos_barrio_hurto, anio==2016)) %>%
mutate(delitos_hab=cant_delitos/poblacion_barrio) %>%
ggplot() +
geom_sf(aes(fill = delitos_hab), color = NA) +
labs(title = "Hurtos 2016",
subtitle="CABA")+
scale_fill_viridis_c(alpha = 0.9)+
theme_void()+
guides(fill=FALSE)
,
barrios %>%
left_join(filter(delitos_barrio_hurto, anio==2017)) %>%
mutate(delitos_hab=cant_delitos/poblacion_barrio) %>%
ggplot() +
geom_sf(aes(fill = delitos_hab), color = NA) +
labs(title = "Hurto 2017",
subtitle="CABA")+
scale_fill_viridis_c(alpha = 0.9)+
theme_void()+
guides(fill=FALSE),
barrios %>%
left_join(filter(delitos_barrio_hurto, anio==2018)) %>%
mutate(delitos_hab=cant_delitos/poblacion_barrio) %>%
ggplot() +
geom_sf(aes(fill = delitos_hab), color = NA) +
labs(title = "Hurto 2018",
subtitle="CABA")+
scale_fill_viridis_c(alpha = 0.9)+
theme_void()+
guides(fill=FALSE)
)
ggparcoord(delitos_barrio_robo %>%
left_join(barrios) %>%
mutate(delitos_hab=cant_delitos/poblacion_barrio) %>%
select(barrio, tipo_delito,anio,delitos_hab) %>%
spread(anio, delitos_hab),
columns = 3:5, groupColumn = 1,
showPoints = TRUE,
title = "Robos por cantidad de habitantes",
alphaLines = 0.3,
scale="globalminmax"
) +
theme(legend.position="none",
plot.title = element_text(size=10)
)+
geom_dl(aes(label = barrio), method = list(dl.trans(x = x + 0.2), cex = 0.8))
ggparcoord(delitos_barrio_hurto %>%
left_join(barrios) %>%
mutate(delitos_hab=cant_delitos/poblacion_barrio) %>%
select(barrio, tipo_delito,anio,delitos_hab) %>%
spread(anio, delitos_hab),
columns = 3:5, groupColumn = 1,
showPoints = TRUE,
title = "Hurtos por cantidad de habitantes",
alphaLines = 0.3,
scale="globalminmax"
) +
theme(legend.position="none",
plot.title = element_text(size=10)
)  +
geom_dl(aes(label = barrio), method = list(dl.trans(x = x + 0.2), "last.qp", cex = 0.8))
delitos_barrio_robo %>%
left_join(barrios) %>%
mutate(delitos_hab=cant_delitos/poblacion_barrio) %>%
select(barrio, tipo_delito,anio,delitos_hab) %>%
spread(anio, delitos_hab)
delitos_barrio_robo %>%
left_join(barrios) %>%
mutate(delitos_hab=cant_delitos/poblacion_barrio) %>%
select(barrio, tipo_delito,anio,delitos_hab)
delitos_barrio_robo %>%
left_join(barrios) %>%
mutate(delitos_hab=cant_delitos/poblacion_barrio) %>%
select(barrio, tipo_delito,anio,delitos_hab) %>%
filter(delitos_hab=max(delitos_hab)) %>%
top_n(value,3)
a <- delitos_barrio_robo %>%
left_join(barrios) %>%
mutate(delitos_hab=cant_delitos/poblacion_barrio) %>%
select(barrio, tipo_delito,anio,delitos_hab)
a %>%
filter(delitos_hab=max(delitos_hab)) %>%
top_n(value,3)
a %>%
filter(delitos_hab==max(delitos_hab)) %>%
top_n(value,3)
a %>%
filter(delitos_hab==max(delitos_hab)) %>%
top_n(delitos_hab,3)
a %>%
filter(delitos_hab==max(delitos_hab)) %>%
top_n(barrio,3)
a %>%
filter(delitos_hab==max(delitos_hab))
a <- delitos_barrio_robo %>%
left_join(barrios) %>%
mutate(delitos_hab=cant_delitos/poblacion_barrio) %>%
select(barrio, tipo_delito,anio,delitos_hab) %>%
arrange(delitos_hab)
delitos_barrio_robo %>%
left_join(barrios) %>%
mutate(delitos_hab=cant_delitos/poblacion_barrio) %>%
select(barrio, tipo_delito,anio,delitos_hab) %>%
arrange(delitos_hab)
delitos_barrio_robo %>%
left_join(barrios) %>%
mutate(delitos_hab=cant_delitos/poblacion_barrio) %>%
select(barrio, tipo_delito,anio,delitos_hab) %>%
arrange(desc(delitos_hab))
delitos_barrio_robo %>%
left_join(barrios) %>%
mutate(delitos_hab=cant_delitos/poblacion_barrio) %>%
select(barrio, tipo_delito,anio,delitos_hab) %>%
arrange(desc(delitos_hab)) %>%
top_n(5)
delitos_barrio_robo %>%
left_join(barrios) %>%
mutate(delitos_hab=cant_delitos/poblacion_barrio) %>%
select(barrio, tipo_delito,anio,delitos_hab) %>%
arrange(desc(delitos_hab)) %>%
top_n(barrio,5)
delitos_barrio_robo %>%
left_join(barrios) %>%
mutate(delitos_hab=cant_delitos/poblacion_barrio) %>%
select(barrio, tipo_delito,anio,delitos_hab) %>%
arrange(desc(delitos_hab)) %>%
top_n(1)
delitos_barrio_robo %>%
left_join(barrios) %>%
mutate(delitos_hab=cant_delitos/poblacion_barrio) %>%
select(barrio, tipo_delito,anio,delitos_hab) %>%
arrange(desc(delitos_hab)) %>%
[1:2]
delitos_barrio_robo %>%
left_join(barrios) %>%
mutate(delitos_hab=cant_delitos/poblacion_barrio) %>%
select(barrio, tipo_delito,anio,delitos_hab) %>%
arrange(desc(delitos_hab))
View(a)
ggplot(a, aes('anio', 'delitos_hab')) +
geom_line()
ggplot(a, aes('anio', 'delitos_hab')) +
geom_line()
ggplot(a, aes(anio, delitos_hab)) +
geom_line()
a <- delitos_barrio_robo %>%
left_join(barrios) %>%
mutate(delitos_hab=cant_delitos/poblacion_barrio) %>%
select(barrio, tipo_delito,anio,delitos_hab) %>%
spread(anio, delitos_hab)
ggparcoord(data=a,
columns = 3:5, groupColumn = 1,
showPoints = TRUE,
title = "Robos por cantidad de habitantes",
alphaLines = 0.3,
scale="globalminmax"
) +
theme(legend.position="none",
plot.title = element_text(size=10)
)+
geom_dl(aes(label = barrio), method = list(dl.trans(x = x + 0.2), cex = 0.8))
ggparcoord(data=a,
columns = 3:5, groupColumn = 1,
showPoints = TRUE,
title = "Robos por cantidad de habitantes",
alphaLines = 0.3,
scale="globalminmax"
) +
theme(legend.position="none",
plot.title = element_text(size=10)
)+
geom_dl(aes(label = barrio), method = list(dl.trans(x = x + 0.2), cex = 0.8))
ggparcoord(delitos_barrio_robo %>%
left_join(barrios) %>%
mutate(delitos_hab=cant_delitos/poblacion_barrio) %>%
select(barrio, tipo_delito,anio,delitos_hab) %>%
spread(anio, delitos_hab),
columns = 3:5, groupColumn = 1,
showPoints = TRUE,
title = "Robos por cantidad de habitantes",
alphaLines = 0.3,
scale="globalminmax"
) +
theme(legend.position="none",
plot.title = element_text(size=10)
)+
geom_dl(aes(label = barrio), method = list(dl.trans(x = x + 0.2), cex = 0.8))
ggparcoord(delitos_barrio_robo %>%
left_join(barrios) %>%
mutate(delitos_hab=cant_delitos/poblacion_barrio) %>%
select(barrio, tipo_delito,anio,delitos_hab) %>%
spread(anio, delitos_hab),
columns = 3:5, groupColumn = 1,
showPoints = TRUE,
title = "Robos por cantidad de habitantes",
alphaLines = 0.3,
scale="globalminmax"
) +
theme(legend.position="none",
plot.title = element_text(size=10)
)+
geom_dl(aes(label = barrio), method = list(dl.trans(x = x + 0.2), cex = 0.8))
ggparcoord(delitos_barrio_robo %>%
left_join(barrios) %>%
mutate(delitos_hab=cant_delitos/poblacion_barrio) %>%
select(barrio, tipo_delito,anio,delitos_hab) %>%
spread(anio, delitos_hab),
columns = 3:5, groupColumn = 1,
showPoints = TRUE,
title = "Robos por cantidad de habitantes",
alphaLines = 0.3,
scale="globalminmax"
) +
theme(legend.position="none",
plot.title = element_text(size=10)
)+
geom_dl(aes(label = barrio), method = list(dl.trans(x = x + 0.2),"last.qp", cex = 0.8))
