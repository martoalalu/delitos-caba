ggplot(data=barrios,
aes(x=delitos_hab,
y=barrio,
fill=delitos_hab))+
geom_bar(width=0.75,
stat='identity',
position='stack')
ggplot(data=barrios,
aes(x=delitos_hab,
y=barrio,
fill=delitos_hab))+
geom_bar()
ggplot(data=barrios,
aes(x=delitos_hab,
y=barrio,
fill=delitos_hab))+
geom_bar(
stat='identity',
position='stack')
ggplot(data=barrios,
aes(x=barrio,
y=delitos_hab,
fill=delitos_hab))+
geom_bar(
stat='identity',
position='stack')
ggplot(data=barrios,
aes(x=barrio,
y=reorder(delitos_hab),
fill=delitos_hab))+
geom_bar(
stat='identity',
position='stack')
ggplot(data=barrios,
aes(x=barrio,
y=arrange(delitos_hab),
fill=delitos_hab))+
geom_bar(
stat='identity',
position='stack')
ggplot(data=barrios,
aes(x=barrio,
y=arrange(desc(delitos_hab)),
fill=delitos_hab))+
geom_bar(
stat='identity',
position='stack')
ggplot(data=barrios,
aes(x=barrio,
y=delitos_hab),
fill=delitos_hab))+
geom_bar(
ggplot(data=barrios,
aes(x=barrio,
y=delitos_hab),
fill=delitos_hab))+
geom_bar(
ggplot(data=barrios,
aes(x=barrio,
y=delitos_hab),
fill=delitos_hab))+
geom_bar(stat='identity',
position='stack')
ggplot(data=barrios,
aes(x=barrio,
y=delitos_hab),
fill=delitos_hab)+
geom_bar(stat='identity',
position='stack')
position='stack')
ggplot(data=barrios,
aes(x=barrio,
y=arrange(desc(delitos_hab)),
fill=delitos_hab))+
geom_bar(stat='identity',
position='stack')
position='stack')
position='stack')
position='stack')
position='stack')
ggplot(data=barrios,
aes(x=barrio,
y=delitos_hab,
fill=delitos_hab))+
geom_bar(stat='identity',
position='stack')
barrios %>%
arrange(desc(delitos_hab)) %>%
ggplot(data=barrios,
aes(x=barrio,
y=delitos_hab,
fill=delitos_hab))+
geom_bar(stat='identity',
position='stack')
barrios %>%
arrange(desc(delitos_hab)) %>%
ggplot(aes(x=barrio,
y=delitos_hab,
fill=delitos_hab))+
geom_bar(stat='identity',
position='stack')
barrios %>%
arrange(desc(delitos_hab))
ggplot(data=barrios,
aes(x=reorder(barrios, delitos_hab),
y=delitos_hab,
fill=factor(barrio)))+
geom_bar(width=0.75,
stat='identity',
position='stack')+
geom_text(size=3.5,aes(x = barrio,
y = delitos_hab , label = delitos_hab))+
coord_flip() +
labs(title = "20 rubros con mayor cantidad de usos",
subtitle = "Ciudad Autónoma de Buenos Aires, 2017",
x = "Rubro",
y = "Cantidad",
fill = "Tipo de uso del suelo") +
guides(fill=FALSE)
ggplot(data=barrios,
aes(x=reorder(barrios, delitos_hab),
y=delitos_hab,
fill=factor(barrio)))+
geom_bar(width=0.75,
stat='identity',
position='stack')
ggplot(data=barrios,
aes(x=reorder(barrios, delitos_hab),
y=delitos_hab,
fill=barrio))+
geom_bar(width=0.75,
stat='identity',
position='stack')
barrios <- barrios %>%
arrange(desc(delitos_hab))
ggplot(aes(x=barrio,
y=delitos_hab,
fill=delitos_hab))+
geom_bar(stat='identity',
position='stack')
ggplot(data=barrios,aes(x=barrio,
y=delitos_hab,
fill=delitos_hab))+
geom_bar(stat='identity',
position='stack')
ggplot(data=barrios,aes(x=barrio,
y=delitos_hab,
fill=delitos_hab))+
geom_bar(stat='identity',
position='stack')+
coord_flip()
ggplot(data=barrios,aes(x=reorder(barrio, delitos_hab),
y=delitos_hab,
fill=delitos_hab))+
geom_bar(stat='identity',
position='stack')+
coord_flip()
ggplot(data=barrios,aes(x=reorder(barrio, delitos_hab),
y=delitos_hab,
fill=delitos_hab))+
geom_bar(stat='identity',
position='stack')+
coord_flip()+
labs(title = "Delitos por habitante en barrios",
subtitle="Ciudad Autónoma de Buenos Aires",
fill = "Cantidad/hab",
caption= "Fuente de datos: https://mapa.seguridadciudad.gob.ar/")+
scale_fill_viridis_c(alpha = 0.9)
ggplot(data=barrios,aes(x=reorder(barrio, delitos_hab),
y=delitos_hab,
fill=delitos_hab))+
geom_bar(stat='identity',
position='stack')+
coord_flip()+
labs(title = "Delitos por habitante en barrios",
subtitle="Ciudad Autónoma de Buenos Aires",
fill = "Cantidad/hab",
caption= "Fuente de datos: https://mapa.seguridadciudad.gob.ar/")+
scale_fill_viridis_c(alpha = 0.9)
ggplot(data=barrios,aes(x=reorder(barrio, delitos_hab),
y=delitos_hab,
fill=delitos_hab))+
geom_bar(stat='identity',
position='stack')+
coord_flip()+
labs(title = "Delitos por habitante en barrios",
subtitle="Ciudad Autónoma de Buenos Aires",
fill = "Cantidad/hab",
caption= "Fuente de datos: https://mapa.seguridadciudad.gob.ar/")
ggplot(data=barrios,aes(x=reorder(barrio, delitos_hab),
y=delitos_hab,
fill=delitos_hab))+
geom_bar(stat='identity',
position='stack')+
coord_flip()+
labs(title = "Delitos por habitante en barrios",
subtitle="Ciudad Autónoma de Buenos Aires",
fill = "Cantidad/hab",
caption= "Fuente de datos: https://mapa.seguridadciudad.gob.ar/")+
scale_fill_viridis_c(alpha = 0.9)
ggplot(data=barrios,aes(x=reorder(barrio, delitos_hab),
y=delitos_hab,
fill=delitos_hab))+
geom_bar(stat='identity',
position='stack')+
coord_flip()+
labs(title = "Delitos por habitante en barrios",
subtitle="Ciudad Autónoma de Buenos Aires",
x="Barrio",
y="Cantidad de delitos por habitante",
fill = "Cantidad/hab",
caption= "Fuente de datos: https://mapa.seguridadciudad.gob.ar/")+
scale_fill_viridis_c(alpha = 0.9)
rm(delitos_barrio)
View(barrios)
delitos <- delitos %>%
mutate(barrio = case_when(grepl(paste(barrios_replace[1]), barrio) ~ "COGHLAN",
grepl(paste(barrios_replace[2]), barrio) ~ "BOCA",
grepl(paste(barrios_replace[3]), barrio) ~ "VILLA GRAL. MITRE",
grepl(paste(barrios_replace[4]), barrio) ~ "MONSERRAT",
TRUE~"OTROS"))
barrios_replace<- c("COGHLAND", "LA BOCA", "VILLA GRAL MITRE", "MONTSERRAT")
delitos <- delitos %>%
mutate(barrio = case_when(grepl(paste(barrios_replace[1]), barrio) ~ "COGHLAN",
grepl(paste(barrios_replace[2]), barrio) ~ "BOCA",
grepl(paste(barrios_replace[3]), barrio) ~ "VILLA GRAL. MITRE",
grepl(paste(barrios_replace[4]), barrio) ~ "MONSERRAT",
TRUE~"OTROS"))
delitos_barrio <- delitoscaba %>%
group_by(barrio, tipo_delito) %>%
summarise(cant_delitos=n())
delitos_barrio <- delitos_caba %>%
group_by(barrio, tipo_delito) %>%
summarise(cant_delitos=n())
View(delitos_barrio)
#Joineamos
barrios %>%
left_join(delitos_barrio) %>%
mutate(delitos_hab=cant_delitos/poblacion_barrio) %>%
filter(tipo_delito=="Robo (Con violencia)") %>%
ggplot() +
geom_sf(aes(fill = delitos_hab), color = NA) +
labs(title = "Delitos por habitante en barrios",
subtitle="Ciudad Autónoma de Buenos Aires",
fill = "Cantidad/hab",
caption= "Fuente de datos: https://mapa.seguridadciudad.gob.ar/")+
scale_fill_viridis_c(alpha = 0.9)+
theme_void()
#Joineamos
barrios %>%
left_join(delitos_barrio) %>%
mutate(delitos_hab=cant_delitos/poblacion_barrio) %>%
filter(tipo_delito=="Robo (Con violencia)")
#Joineamos
barrios %>%
left_join(delitos_barrio)
#Joineamos
barrios <- barrios %>%
left_join(delitos_barrio)
#Delitos por barrio
delitos_barrio <- delitos_caba %>%
group_by(barrio) %>%
summarise(cant_delitos=n())
#Joineamos
barrios <- barrios %>%
left_join(delitos_barrio)
delitos_caba_geo <- delitos_caba
st_geometry(delitos_caba) <- NULL
#Joineamos
barrios <- barrios %>%
left_join(delitos_barrio)%>%
mutate(delitos_hab=cant_delitos/poblacion_barrio) %>%
filter(tipo_delito=="Robo (Con violencia)") %>%
ggplot() +
geom_sf(data = barrios, aes(fill = delitos_hab), color = NA) +
labs(title = "Delitos por habitante en barrios",
subtitle="Ciudad Autónoma de Buenos Aires",
fill = "Cantidad/hab",
caption= "Fuente de datos: https://mapa.seguridadciudad.gob.ar/")+
scale_fill_viridis_c(alpha = 0.9)+
theme_void()
#Delitos por barrio
delitos_barrio <- delitos_caba %>%
group_by(barrio) %>%
summarise(cant_delitos=n())
#Joineamos
barrios %>%
left_join(delitos_barrio) %>%
mutate(delitos_hab=cant_delitos/poblacion_barrio) %>%
ggplot() +
geom_sf(aes(fill = delitos_hab), color = NA) +
labs(title = "Delitos por habitante en barrios",
subtitle="Ciudad Autónoma de Buenos Aires",
fill = "Cantidad/hab",
caption= "Fuente de datos: https://mapa.seguridadciudad.gob.ar/")+
scale_fill_viridis_c(alpha = 0.9)+
theme_void()
View(barrios)
#Poblacion por barrio
barrios <- radios %>%
group_by(BARRIO) %>%
summarise(poblacion_barrio=sum(POBLACION)) %>%
clean_names()
#Delitos por barrio
delitos_barrio <- delitos_caba %>%
group_by(barrio) %>%
summarise(cant_delitos=n())
#Delitos por barrio
delitos_barrio <- delitos_caba %>%
group_by(barrio, tipo_delito) %>%
summarise(cant_delitos=n())
View(delitos_barrio)
theme_void()
barrios %>%
left_join(filter(delitos_barrio=="Robo (Con violencia)") %>%
mutate(delitos_hab=cant_delitos/poblacion_barrio) %>%
ggplot() +
geom_sf(aes(fill = delitos_hab), color = NA) +
labs(title = "Delitos por habitante en barrios",
subtitle="Ciudad Autónoma de Buenos Aires",
fill = "Cantidad/hab",
caption= "Fuente de datos: https://mapa.seguridadciudad.gob.ar/")+
scale_fill_viridis_c(alpha = 0.9)+
theme_void()
#Joineamos
barrios %>%
left_join(filter(delitos_barrio=="Robo (Con violencia)")) %>%
mutate(delitos_hab=cant_delitos/poblacion_barrio) %>%
ggplot() +
geom_sf(aes(fill = delitos_hab), color = NA) +
labs(title = "Delitos por habitante en barrios",
subtitle="Ciudad Autónoma de Buenos Aires",
fill = "Cantidad/hab",
caption= "Fuente de datos: https://mapa.seguridadciudad.gob.ar/")+
scale_fill_viridis_c(alpha = 0.9)+
theme_void()
delitos_barrio_robo <- filter(delitos_barrio, delitos_barrio$tipo_delito=="Robo (Con violencia)")
delitos_barrio_robo <- filter(delitos_barrio$tipo_delito=="Robo (Con violencia)")
delitos_barrio_robo <- filter(delitos_barrio, delitos_barrio$tipo_delito=="Robo (Con violencia)")
View(delitos_barrio)
filter(delitos_barrio, delitos_barrio$tipo_delito=="Robo (Con violencia)")
delitos_barrio %>%
filter(delitos_barrio$tipo_delito=="Robo (Con violencia)")
delitos_barrio_robo <- filter(delitos_barrio, tipo_delito=="Robo (Con violencia)")
delitos_barrio_hurto <- filter(delitos_barrio, tipo_delito=="Hurto (Sin violencia)")
#Joineamos robos, agregamos cantidad de delitos por habitante y mapeamos
barrios %>%
left_join(delitos_barrio_robo) %>%
mutate(delitos_hab=cant_delitos/poblacion_barrio) %>%
ggplot() +
geom_sf(aes(fill = delitos_hab), color = NA) +
labs(title = "Robos por cantidad de habitantes en barrios",
subtitle="Ciudad Autónoma de Buenos Aires",
fill = "Cantidad/hab",
caption= "Fuente de datos: https://mapa.seguridadciudad.gob.ar/")+
scale_fill_viridis_c(alpha = 0.9)+
theme_void()
barrios %>%
left_join(delitos_barrio_robo) %>%
mutate(delitos_hab=cant_delitos/poblacion_barrio) %>%
ggplot() +
geom_sf(aes(fill = delitos_hab), color = NA) +
labs(title = "Robos por cantidad de habitantes en barrios",
subtitle="Ciudad Autónoma de Buenos Aires",
fill = "Cantidad/hab",
caption= "Fuente de datos: https://mapa.seguridadciudad.gob.ar/")+
scale_fill_viridis_c(alpha = 0.9)+
theme_void()
barrios %>%
left_join(delitos_barrio) %>%
mutate(delitos_hab=cant_delitos/poblacion_barrio) %>%
ggplot() +
geom_sf(aes(fill = delitos_hab), color = NA) +
labs(title = "Delitos por habitante en barrios",
subtitle="Ciudad Autónoma de Buenos Aires",
fill = "Cantidad/hab",
caption= "Fuente de datos: https://mapa.seguridadciudad.gob.ar/")+
scale_fill_viridis_c(alpha = 0.9)+
theme_void()
barrios %>%
left_join(delitos_barrio_robo) %>%
mutate(delitos_hab=cant_delitos/poblacion_barrio) %>%
ggplot() +
geom_sf(aes(fill = delitos_hab), color = NA) +
labs(title = "Robos por cantidad de habitantes en barrios",
subtitle="Ciudad Autónoma de Buenos Aires",
fill = "Cantidad/hab",
caption= "Fuente de datos: https://mapa.seguridadciudad.gob.ar/")+
scale_fill_viridis_c(alpha = 0.9)+
theme_void()
View(delitos_barrio_robo)
library(data.table)
library(tidyverse)
library(sf)
library(ggplot2)
library(dplyr)
library(viridis)
library(data.table)
library(ggmap)
library(janitor)
library(ggdark)
library(leaflet)
library(lubridate)
delitos <- fread("https://raw.githubusercontent.com/martoalalu/delitos-caba/master/data/delitos.csv",encoding = 'UTF-8')
barrios_replace<- c("COGHLAND", "LA BOCA", "VILLA GRAL MITRE", "MONTSERRAT")
delitos <- delitos %>%
mutate(fecha=ymd(fecha)) %>%
mutate(anio=year(fecha)) %>%
mutate(anio_mes = floor_date(as_date(fecha), "month")) %>%
mutate(barrio = case_when(grepl(paste(barrios_replace[1]), barrio) ~ "COGHLAN",
grepl(paste(barrios_replace[2]), barrio) ~ "BOCA",
grepl(paste(barrios_replace[3]), barrio) ~ "VILLA GRAL. MITRE",
grepl(paste(barrios_replace[4]), barrio) ~ "MONSERRAT",
TRUE~"OTROS"))
nrow(delitos)/(365*3)
delitos %>%
count(anio) %>%
mutate(pct=(n/sum(n))*100)
delitos %>%
ggplot(aes(anio))+
geom_bar(aes(fill=as.factor(tipo_delito)))+
labs(title="Distribución de delitos por año (2016-2018)",
subtitle="Ciudad Autónoma de Buenos Aires",
caption= "Fuente de datos: https://https://mapa.seguridadciudad.gob.ar/",
fill="Tipo de delito")
delitos %>%
count(anio_mes,tipo_delito) %>%
ggplot() +
geom_line(aes(x=anio_mes, y=n, color=tipo_delito))+
xlab("")+
labs(title="Distribución de delitos por mes (2016-2018)",
subtitle="Ciudad Autónoma de Buenos Aires",
caption= "Fuente de datos: https://https://mapa.seguridadciudad.gob.ar/",
fill="Tipo de delito")
#Creamos df con delitos de robo y hurto que tengan coordenadas
delitos_geo <- delitos %>%
filter(!is.na(longitud), !is.na(latitud)) %>%
filter(longitud != 0) %>%
filter(tipo_delito=="Robo (Con violencia)" | tipo_delito=="Hurto (Sin violencia)") %>%
st_as_sf(coords = c("longitud", "latitud"), crs = 4326)
#Nos quedamos solo con los delitos ocurridos en la Ciudad de Buenos Aires
radios <- read_sf("http://cdn.buenosaires.gob.ar/datosabiertos/datasets/informacion-censal-por-radio/caba_radios_censales.geojson")
delitos_caba <- delitos_geo[st_within(delitos_geo, radios) %>% lengths > 0,]
delitos_caba<- delitos_caba %>%
mutate(long=st_coordinates(delitos_caba)[,1],
lat=st_coordinates(delitos_caba)[,2])
bbox <- c(-58.546686,
-34.711145,
-58.329097,
-34.529156)
CABA <- get_stamenmap(bbox = bbox,
maptype = "toner-lite",
zoom=13)
ggmap(CABA) +
stat_density_2d(data = filter(delitos_caba,tipo_delito=="Robo (Con violencia)"),
aes(x = long, y = lat,
fill = stat(level)), alpha = 0.6, geom = "polygon") +
labs(title="Distribución de Robo (con violencia) 2016-2018",
subtitle="Ciudad Autónoma de Buenos Aires",
x="",
y="",
caption= "Fuente de datos: https://mapa.seguridadciudad.gob.ar/",
fill="Nivel")+
scale_fill_distiller(palette = "Spectral")+
theme_void()+
facet_wrap(~anio)
ggmap(CABA) +
stat_density_2d(data = filter(delitos_caba,tipo_delito=="Hurto (Sin violencia)"),
aes(x = long, y = lat,
fill = stat(level)), alpha = 0.6, geom = "polygon") +
labs(title="Distribución de Hurto (sin violencia) 2016-2018",
subtitle="Ciudad Autónoma de Buenos Aires",
x="",
y="",
caption= "Fuente de datos: https://mapa.seguridadciudad.gob.ar/",
fill="Nivel")+
scale_fill_distiller(palette = "Spectral")+
theme_void()+
facet_wrap(~anio)
#Poblacion por barrio
barrios <- radios %>%
group_by(BARRIO) %>%
summarise(poblacion_barrio=sum(POBLACION)) %>%
clean_names()
#Mapeamos poblacion
ggplot() +
geom_sf(data = barrios, aes(fill = poblacion_barrio), color = NA) +
labs(title = "Poblacion por Barrio",
subtitle="Ciudad Autónoma de Buenos Aires",
fill = "Cantidad",
caption= "Fuente de datos: https://mapa.seguridadciudad.gob.ar/")+
scale_fill_viridis_c(alpha = 0.9)
delitos_caba_geo <- delitos_caba
st_geometry(delitos_caba) <- NULL
#Delitos por barrio
delitos_barrio <- delitos_caba %>%
group_by(barrio, tipo_delito) %>%
summarise(cant_delitos=n())
delitos_barrio_robo <- filter(delitos_barrio, tipo_delito=="Robo (Con violencia)")
delitos_barrio_hurto <- filter(delitos_barrio, tipo_delito=="Hurto (Sin violencia)")
#Joineamos robos, agregamos cantidad de delitos por habitante y mapeamos
barrios %>%
left_join(delitos_barrio_robo) %>%
mutate(delitos_hab=cant_delitos/poblacion_barrio) %>%
ggplot() +
geom_sf(aes(fill = delitos_hab), color = NA) +
labs(title = "Robos por cantidad de habitantes en barrios",
subtitle="Ciudad Autónoma de Buenos Aires",
fill = "Cantidad/hab",
caption= "Fuente de datos: https://mapa.seguridadciudad.gob.ar/")+
scale_fill_viridis_c(alpha = 0.9)+
theme_void()
